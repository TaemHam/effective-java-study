# 아이템 66. 네이티브 메서드는 신중히 사용하라

## 자바 네이티브 인터페이스 (JNI)란?

- 자바 네이티브 인터페이스는 자바 프로그램이 네이티브 메서드를 호출하는 기술이다.

- 쉽게 말하면 자바 프로그램에서 다른 언어로 작성된 코드를 호출하도록 만들어진 규약이다.

- [JNI 더 알아보기](https://roughexistence.tistory.com/81)

- [JNI는 JVM에서 어디에 있을까요..?](https://d2.naver.com/helloworld/1230)
  <br>

## 네이티브 메서드의 주요 쓰임 세 가지

- 윈도우의 레지스트리 같은 특정 플랫폼이나 OS에 특화된 기능을 사용할 때

- 네이티브 코드 (C나 C++ 같은 언어)로 작성된 기존 라이브러리 (DLL 같은 것)를 자바에서 사용할 때

- 성능 개선을 목적으로 성능에 결정적인 영향을 주는 영역만 따로 네이티브 언어로 작성할 때

<br>

## 성능을 개선할 목적으로 네이티브 메서드를 사용하는 것은 권장하지 않는다.

- 플랫폼 특화 기능을 사용하려면 네이티브 메서드를 써야한다.

- 그러나 자바의 버전이 올라가면서 OS 같은 플랫폼의 기능들을 점차 흡수하고 있다.

- 또 자바의 Process API를 통해 OS 프로세스를 직접 실행할 수도 있다.
  - [Java에서 외부 프로세스 실행하기](https://d2.naver.com/helloworld/1113548)

<br>

## 네이티브 메서드의 단점

- 네이티브 메서드를 쓰는 경우 메모리 훼손 오류가 발생할 가능성이 높다.

  - 예를 들어 C로 작성된 네이티브 메서드를 쓸 때 메모리 이슈가 생기면 자바 APP에서는 알 수 없다.

  - [Java memoey leak 트러블 슈팅 참고 영상](https://www.youtube.com/watch?v=w4fWgLgop5U)

- 특정 플랫폼에 종속될 수 있기 때문에 이식성이 낮다.

- 디버깅이 어렵다.

  ```java
  // Thread.currentThread()의 경우 native 메서드인데
  // IDE의 디버깅 툴 사용 시 break point가 걸리지 않아 디버깅을 하기 어렵다.
  public static void main(String[] args) {
      Thread myThread = Thread.currentThread();
  }
  ```

- 마지막으로 네이티브 메서드와 자바 코드를 연결할 접착 코드 (glue code)도 작성해야 하는데 이 작업도 번거롭다.
