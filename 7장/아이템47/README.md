# ì•„ì´í…œ 47. ë°˜í™˜ íƒ€ì…ìœ¼ë¡œëŠ” ìŠ¤íŠ¸ë¦¼ë³´ë‹¤ ì»¬ë ‰ì…˜ì´ ë‚«ë‹¤

## ì¼ë ¨ì˜ ì›ì†Œë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ë²•

- ì¼ë ¨ì˜ ì›ì†Œ (ì›ì†Œ ì‹œí€€ìŠ¤)ë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ê°€ ìˆë‹¤.

  > ğŸ“Œ **ì°¸ê³ **
  >
  > - ì¼ë ¨ì˜ ì›ì†Œ (ì›ì†Œ ì‹œí€€ìŠ¤)ëŠ” ì‰½ê²Œ ë§í•´ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ê°œ ë‹´ì„ ìˆ˜ ìˆëŠ” íƒ€ì…ì´ë¼ê³  ìƒê°í•˜ì.
  > - ì˜ˆë¥¼ ë“¤ì–´ ì»¬ë ‰ì…˜, ë°°ì—´, ìŠ¤íŠ¸ë¦¼ ë“±ì´ ìˆë‹¤.

- ìë°” 7ê¹Œì§€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì›ì†Œ ì‹œí€€ìŠ¤ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆì—ˆë‹¤.
  - Collection, Set, List ê°™ì€ ì»¬ë ‰ì…˜ ì¸í„°í˜ì´ìŠ¤
  - Iterable
  - ë°°ì—´

<br>

## ìŠ¤íŠ¸ë¦¼ì€ ë°˜ë³µì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.

- ì‚¬ì‹¤ ìŠ¤íŠ¸ë¦¼ì´ ë°˜ë³µì„ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì€ 45ì¥ì—ì„œ í•™ìŠµí•˜ì˜€ë‹¤.

- ë”°ë¼ì„œ ìŠ¤íŠ¸ë¦¼ê³¼ ë°˜ë³µì„ ì•Œë§ê²Œ ì¡°í•©í•´ì•¼ ì¢‹ì€ ì½”ë“œê°€ ë‚˜ì˜¨ë‹¤.

  > ğŸ“Œ **ì°¸ê³ **
  >
  > - ìŠ¤íŠ¸ë¦¼ì€ Iterable ì¸í„°í˜ì´ìŠ¤ê°€ ì •ì˜í•œ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì „ë¶€ í¬í•¨í•˜ê³  Iterable ì¸í„°í˜ì´ìŠ¤ê°€ ì •ì˜í•œ ë°©ì‹ëŒ€ë¡œ ë™ì‘í•œë‹¤. (êµ¬í˜„ì´ ì•„ë‹ˆë‹¤.)
  > - ê·¸ëŸ¬ë‚˜ forEachë¡œ ìŠ¤íŠ¸ë¦¼ì„ ë°˜ë³µí•˜ì§€ ëª»í•˜ëŠ” ì´ìœ ëŠ” ìŠ¤íŠ¸ë¦¼ì´ Iterableì„ extend í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ë‹¤.
  >   - ì°¸ê³ ë¡œ ìë°”ì—ì„œ ë°˜ë³µë¬¸ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ì›ì†Œ ì‹œí€€ìŠ¤ëŠ” iterableì´ì–´ì•¼ í•œë‹¤.

<br>

## ìŠ¤íŠ¸ë¦¼ì„ ë°˜ë³µí•˜ëŠ” ë°©ë²• 2ê°€ì§€

- ìŠ¤íŠ¸ë¦¼ì„ ë°˜ë³µí•˜ë ¤ë©´ ìŠ¤íŠ¸ë¦¼ì„ Iterableë¡œ í˜•ë³€í™˜í•˜ì.

```java
public static void main(String[] args) {
    Stream<Integer> stream = Stream.of(1, 2, 3, 4, 5);

    // ìŠ¤íŠ¸ë¦¼ì„ iteratorë¡œ í˜•ë³€í™˜í•˜ì—¬ forë¬¸ì—ì„œ ì‚¬ìš©í•œë‹¤.
    for (Integer num : (Iterable<Integer>) stream::iterator) {
        System.out.println("num = " + num);
    }
}
```

- ìŠ¤íŠ¸ë¦¼ê³¼ Iterableì„ ì¤‘ê°œí•´ì£¼ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ ì‚¬ìš©í•˜ê¸°.

```java
// ìŠ¤íŠ¸ë¦¼ì„ iterableë¡œ ë³€í™˜í•´ì£¼ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ
public static <E> Iterable<E> iterableOf(Stream<E> stream) {
    return stream::iterator;
}

public static void main(String[] args) {
    Stream<Integer> stream = Stream.of(1, 2, 3, 4, 5);

    for (Integer num : iterableOf(stream)) {
        System.out.println("num = " + num);
    }
}
```

<br>

## APIë¥¼ ë§Œë“¤ ë•Œ, Streamì„ ë°˜í™˜? Iterableì„ ë°˜í™˜?

### Streamì„ ë°˜í™˜í•˜ëŠ” ê²½ìš°

- ì´ ë©”ì„œë“œê°€ ì˜¤ì§ ìŠ¤íŠ¸ë¦¼ íŒŒì´í”„ ë¼ì¸ì—ì„œë§Œ ì“°ì¼ ê±¸ ì•ˆë‹¤ë©´ ìŠ¤íŠ¸ë¦¼ì„ ë°˜í™˜í•˜ì.

- Streamì„ iterableë¡œ ë³€í™˜í•˜ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ

  - í´ë¼ì´ì–¸íŠ¸ëŠ” ë°˜í™˜ë°›ì€ ìŠ¤íŠ¸ë¦¼ì„ iterableë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

  ```java
  // ìŠ¤íŠ¸ë¦¼ì„ iterableë¡œ ë³€í™˜í•´ì£¼ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ
  public static <E> Iterable<E> iterableOf(Stream<E> stream) {
      return stream::iterator;
  }
  ```

### Iterableì„ ë°˜í™˜í•˜ëŠ” ê²½ìš°

- ì´ ë©”ì„œë“œê°€ ì˜¤ì§ ë°˜ë³µë¬¸ì—ì„œë§Œ ì“°ì¼ ê±¸ ì•ˆë‹¤ë©´ Iterableì„ ë°˜í™˜í•˜ì.

- Streamì„ iterableë¡œ ë³€í™˜í•˜ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ

  - í´ë¼ì´ì–¸íŠ¸ëŠ” ë°˜í™˜ë°›ì€ iterableì„ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

  ```java
  // iterableì„ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì–´ëŒ‘í„° ë©”ì„œë“œ
  public static <E> Stream<E> streamOf(Iterable<E> iterable) {
      return StreamSupport.stream(iterable.spliterator(), false);
  }
  ```

<br>

## Collectionì„ ë°˜í™˜í•˜ì

- Collectionì€ Iterableì˜ í•˜ìœ„ íƒ€ì…ì´ë©°, stream ë©”ì„œë“œë„ ì œê³µí•œë‹¤.

- Collectionì€ Iterableì„ ì§€ì›í•˜ë©´ì„œë„ ìŠ¤íŠ¸ë¦¼ë„ ë™ì‹œì— ì§€ì›í•˜ëŠ” ê²ƒì´ë‹¤.

- ë”°ë¼ì„œ ì¼ë ¨ì˜ ì›ì†Œ(ì›ì†Œ ì‹œí€€ìŠ¤)ë¥¼ ë°˜í™˜í•˜ëŠ” ê³µê°œ APIì—ì„œëŠ” Collectionì´ë‚˜ ê·¸ í•˜ìœ„ íƒ€ì…ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

  - ì™œëƒí•˜ë©´ í´ë¼ì´ì–¸íŠ¸ê°€ iterableì´ë‚˜ streamì„ ì‰½ê²Œ ì„ íƒí•˜ì—¬ ë°˜í™˜ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

  > ğŸ“Œ **ì£¼ì˜**
  >
  > - ê·¸ëŸ¬ë‚˜ Collectionì˜ í¬ê¸°ê°€ ì—„ì²­ ì»¤ì§€ëŠ” ê²½ìš° ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ë©´ ì•ˆë˜ë¯€ë¡œ ë°˜í™˜ íƒ€ì…ì„ ì–´ë–»ê²Œ í• ì§€ ë°˜ë“œì‹œ ê³ ë ¤í•´ì•¼ í•œë‹¤.

<br>

## Collectionì´ ë„ˆë¬´ ì»¤ì„œ ì „ìš© ì»¬ë ‰ì…˜ì„ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì˜ˆì œ

- ë‹¤ìŒì€ ì£¼ì–´ì§„ ì§‘í•©ì˜ ë©±ì§‘í•© (í•œ ì§‘í•©ì˜ ëª¨ë“  ë¶€ë¶„ ì§‘í•©ì„ ì›ì†Œë¡œ í•˜ëŠ” ì§‘í•©)ì„ ë°˜í™˜í•˜ëŠ” ê²½ìš°ì´ë‹¤.

- ì˜ˆë¥¼ ë“¤ì–´ ì›ì†Œì˜ ê°¯ìˆ˜ê°€ nê°œë©´ ë©±ì§‘í•©ì˜ ì›ì†Œì˜ ê°¯ìˆ˜ëŠ” 2^nê°œì´ë‹¤.

- ì´ëŸ¬í•œ ê²½ìš° Javaì—ì„œ ì œê³µí•˜ëŠ” List, Set ë“±ì˜ ê¸°ë³¸ ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë³„ë„ì˜ ì»¬ë ‰ì…˜ì„ ì§ì ‘ ì •ì˜í•˜ëŠ” ê²ƒì´ ë‚«ë‹¤.

```java
public class PowerSet {
	public static final <E> Collection<Set<E>> of(Set<E> s) {
        // ì›ì†Œë¥¼ ë‹´ì€ ë¦¬ìŠ¤íŠ¸
		List<E> src = new ArrayList<>(s);

        // Collectionì˜ sizeëŠ” int íƒ€ì…ì´ë¯€ë¡œ 2^31 - 1 í¬ê¸°ê¹Œì§€ì˜ sizeë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.
		if (src.size() > 30) {
			throw new IllegalArgumentException("ì§‘í•©ì— ì›ì†Œê°€ ë„ˆë¬´ ë§ìŠµë‹ˆë‹¤.(ìµœëŒ€ 30ê°œ)".: + s);
        }

		return new AbstractList<Set<E>>() {
			@Override public int size() {
				// ë©±ì§‘í•©ì˜ í¬ê¸°ëŠ” 2ë¥¼ ì›ë˜ ì§‘í•©ì˜ ì›ì†Œ ìˆ˜ë§Œí¼ ê±°ë“­ì œê³±ê³¼ ê°™ë‹¤.
				return 1 << src.size();
			}

			@Override public boolean contains(Object o) {
				return o instanceof Set && src.containsAll((Set)o);
			}

			@Override public Set<E> get(int index) {
				Set<E> result = new HashSet<>();
				for (int i = 0; index != 0; i++, index >>=1)
					if ((index & 1) == 1) {
						result.add(src.get(i));
                    }
					return result;
			}
		};
	}
}
```

<br>

## ê²°ë¡ 

- ì¼ë ¨ì˜ ì›ì†Œ (ì›ì†Œ ì‹œí€€ìŠ¤)ë¥¼ ë°˜í™˜í•˜ëŠ” ê²½ìš°ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ìŠ¤íŠ¸ë¦¼, iterable ì¤‘ í¸í•œ ê²ƒì„ ì‰½ê²Œ ì„ íƒí•  ìˆ˜ ìˆê²Œ Collectionìœ¼ë¡œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

- ë§Œì•½ ë°˜í™˜í•˜ëŠ” ì»¬ë ‰ì…˜ì— ë‹´ê¸°ëŠ” ì›ì†Œê°€ ì ìœ¼ë©´ ArrayList ê°™ì€ ê¸°ë³¸ ì»¬ë ‰ì…˜ì— ë‹´ì•„ì„œ ë°˜í™˜í•˜ì.

- ë§Œì•½ ì•ì„  ì˜ˆì œì¸ ë©±ì§‘í•©ì²˜ëŸ¼ ì»¬ë ‰ì…˜ì— ë‹´ê¸°ëŠ” ì›ì†Œê°€ ë§ì•„ ë©”ëª¨ë¦¬ ì´ìŠˆê°€ ìƒê¸¸ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë©´ ì „ìš© ì»¬ë ‰ì…˜ì„ ë³„ë„ë¡œ êµ¬í˜„í• ì§€ë¥¼ ê³ ë¯¼í•˜ì.

- ì»¬ë ‰ì…˜ì„ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë©´, ìŠ¤íŠ¸ë¦¼ê³¼ iterable ì¤‘ ë°˜í™˜í–ˆì„ ë•Œ ë”ìš± ìì—°ìŠ¤ëŸ¬ìš´ ê²ƒì„ ë°˜í™˜í•˜ì.
